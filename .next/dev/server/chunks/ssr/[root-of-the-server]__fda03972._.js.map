{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,oOAAO,EAAC,IAAA,8LAAI,EAAC;AACtB"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,kPAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,4SAAI,GAAG;IAE9B,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/lib/db-utils.ts"],"sourcesContent":["interface Expense {\n  id: string\n  merchant: string\n  amount: number\n  category: string\n  date: string\n  receipt?: string\n}\n\nfunction openIndexedDB(): Promise<IDBDatabase> {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('ReceiptSnapDB', 1)\n    request.onerror = () => reject(request.error)\n    request.onsuccess = () => resolve(request.result)\n    request.onupgradeneeded = (event) => {\n      const db = (event.target as IDBOpenDBRequest).result\n      if (!db.objectStoreNames.contains('expenses')) {\n        db.createObjectStore('expenses', { keyPath: 'id' })\n      }\n      if (!db.objectStoreNames.contains('metadata')) {\n        db.createObjectStore('metadata', { keyPath: 'key' })\n      }\n      if (!db.objectStoreNames.contains('rules')) {\n        db.createObjectStore('rules', { keyPath: 'id' })\n      }\n    }\n  })\n}\n\nexport async function saveExpenseToIndexedDB(data: any): Promise<Expense> {\n  const db = await openIndexedDB()\n  \n  // Use 'total' from AI or fallback to 'amount'\n  let amount = data.total || data.amount || 0\n  \n  // Ensure it's a valid number\n  if (typeof amount === 'string') {\n    amount = parseFloat(amount.replace(/[^0-9.-]/g, '')) || 0\n  } else {\n    amount = Number(amount) || 0\n  }\n  \n  // Ensure it's finite\n  if (!isFinite(amount)) {\n    amount = 0\n  }\n  \n  const expense: Expense = {\n    id: crypto.randomUUID(),\n    merchant: data.merchant || 'Unknown',\n    amount: Math.abs(amount), // Ensure positive\n    category: data.category || 'Other',\n    date: data.date || new Date().toISOString(),\n  }\n\n  // Save expense\n  await new Promise((resolve, reject) => {\n    const tx = db.transaction('expenses', 'readwrite')\n    const store = tx.objectStore('expenses')\n    const request = store.add(expense)\n    request.onerror = () => reject(request.error)\n    request.onsuccess = () => resolve(null)\n  })\n\n  // Update scan count\n  const tx = db.transaction('metadata', 'readwrite')\n  const store = tx.objectStore('metadata')\n  await new Promise((resolve) => {\n    const request = store.get('scanCount')\n    request.onsuccess = () => {\n      const current = request.result?.value || 0\n      const updateRequest = store.put({ key: 'scanCount', value: current + 1 })\n      updateRequest.onsuccess = () => resolve(null)\n    }\n  })\n\n  return expense\n}\n\nexport async function deleteExpenseFromIndexedDB(id: string): Promise<void> {\n  const db = await openIndexedDB()\n  return new Promise((resolve, reject) => {\n    const tx = db.transaction('expenses', 'readwrite')\n    const store = tx.objectStore('expenses')\n    const request = store.delete(id)\n    request.onerror = () => reject(request.error)\n    request.onsuccess = () => resolve()\n  })\n}\n"],"names":[],"mappings":";;;;;;AASA,SAAS;IACP,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,UAAU,UAAU,IAAI,CAAC,iBAAiB;QAChD,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;QAC5C,QAAQ,SAAS,GAAG,IAAM,QAAQ,QAAQ,MAAM;QAChD,QAAQ,eAAe,GAAG,CAAC;YACzB,MAAM,KAAK,AAAC,MAAM,MAAM,CAAsB,MAAM;YACpD,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,aAAa;gBAC7C,GAAG,iBAAiB,CAAC,YAAY;oBAAE,SAAS;gBAAK;YACnD;YACA,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,aAAa;gBAC7C,GAAG,iBAAiB,CAAC,YAAY;oBAAE,SAAS;gBAAM;YACpD;YACA,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,UAAU;gBAC1C,GAAG,iBAAiB,CAAC,SAAS;oBAAE,SAAS;gBAAK;YAChD;QACF;IACF;AACF;AAEO,eAAe,uBAAuB,IAAS;IACpD,MAAM,KAAK,MAAM;IAEjB,8CAA8C;IAC9C,IAAI,SAAS,KAAK,KAAK,IAAI,KAAK,MAAM,IAAI;IAE1C,6BAA6B;IAC7B,IAAI,OAAO,WAAW,UAAU;QAC9B,SAAS,WAAW,OAAO,OAAO,CAAC,aAAa,QAAQ;IAC1D,OAAO;QACL,SAAS,OAAO,WAAW;IAC7B;IAEA,qBAAqB;IACrB,IAAI,CAAC,SAAS,SAAS;QACrB,SAAS;IACX;IAEA,MAAM,UAAmB;QACvB,IAAI,OAAO,UAAU;QACrB,UAAU,KAAK,QAAQ,IAAI;QAC3B,QAAQ,KAAK,GAAG,CAAC;QACjB,UAAU,KAAK,QAAQ,IAAI;QAC3B,MAAM,KAAK,IAAI,IAAI,IAAI,OAAO,WAAW;IAC3C;IAEA,eAAe;IACf,MAAM,IAAI,QAAQ,CAAC,SAAS;QAC1B,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,MAAM,QAAQ,GAAG,WAAW,CAAC;QAC7B,MAAM,UAAU,MAAM,GAAG,CAAC;QAC1B,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;QAC5C,QAAQ,SAAS,GAAG,IAAM,QAAQ;IACpC;IAEA,oBAAoB;IACpB,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;IACtC,MAAM,QAAQ,GAAG,WAAW,CAAC;IAC7B,MAAM,IAAI,QAAQ,CAAC;QACjB,MAAM,UAAU,MAAM,GAAG,CAAC;QAC1B,QAAQ,SAAS,GAAG;YAClB,MAAM,UAAU,QAAQ,MAAM,EAAE,SAAS;YACzC,MAAM,gBAAgB,MAAM,GAAG,CAAC;gBAAE,KAAK;gBAAa,OAAO,UAAU;YAAE;YACvE,cAAc,SAAS,GAAG,IAAM,QAAQ;QAC1C;IACF;IAEA,OAAO;AACT;AAEO,eAAe,2BAA2B,EAAU;IACzD,MAAM,KAAK,MAAM;IACjB,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,MAAM,QAAQ,GAAG,WAAW,CAAC;QAC7B,MAAM,UAAU,MAAM,MAAM,CAAC;QAC7B,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;QAC5C,QAAQ,SAAS,GAAG,IAAM;IAC5B;AACF"}},
    {"offset": {"line": 276, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/lib/receipt-rules.ts"],"sourcesContent":["export interface ReceiptRule {\n  id: string\n  merchant: string\n  category: 'Food' | 'Travel' | 'Office' | 'Other'\n}\n\nexport async function getReceiptRules(): Promise<ReceiptRule[]> {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('ReceiptSnapDB', 1)\n    request.onsuccess = () => {\n      const db = request.result\n      const tx = db.transaction('rules', 'readonly')\n      const store = tx.objectStore('rules')\n      const getAllRequest = store.getAll()\n      getAllRequest.onsuccess = () => resolve(getAllRequest.result || [])\n      getAllRequest.onerror = () => reject(getAllRequest.error)\n    }\n    request.onerror = () => reject(request.error)\n  })\n}\n\nexport async function addReceiptRule(merchant: string, category: ReceiptRule['category']): Promise<ReceiptRule> {\n  const rule: ReceiptRule = {\n    id: crypto.randomUUID(),\n    merchant: merchant.toLowerCase().trim(),\n    category,\n  }\n\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('ReceiptSnapDB', 1)\n    request.onsuccess = () => {\n      const db = request.result\n      const tx = db.transaction('rules', 'readwrite')\n      const store = tx.objectStore('rules')\n      const addRequest = store.add(rule)\n      addRequest.onsuccess = () => resolve(rule)\n      addRequest.onerror = () => reject(addRequest.error)\n    }\n    request.onerror = () => reject(request.error)\n  })\n}\n\nexport async function deleteReceiptRule(id: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('ReceiptSnapDB', 1)\n    request.onsuccess = () => {\n      const db = request.result\n      const tx = db.transaction('rules', 'readwrite')\n      const store = tx.objectStore('rules')\n      const deleteRequest = store.delete(id)\n      deleteRequest.onsuccess = () => resolve()\n      deleteRequest.onerror = () => reject(deleteRequest.error)\n    }\n    request.onerror = () => reject(request.error)\n  })\n}\n\nexport async function applyReceiptRules(merchant: string, category: string): Promise<string> {\n  try {\n    const rules = await getReceiptRules()\n    const merchantLower = merchant.toLowerCase()\n    const matchedRule = rules.find(r => merchantLower.includes(r.merchant) || r.merchant.includes(merchantLower))\n    return matchedRule ? matchedRule.category : category\n  } catch (e) {\n    return category\n  }\n}\n\nexport function exportRulesToJSON(rules: ReceiptRule[]): string {\n  return JSON.stringify(rules)\n}\n\nexport function importRulesFromJSON(jsonStr: string): ReceiptRule[] {\n  return JSON.parse(jsonStr)\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAMO,eAAe;IACpB,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,UAAU,UAAU,IAAI,CAAC,iBAAiB;QAChD,QAAQ,SAAS,GAAG;YAClB,MAAM,KAAK,QAAQ,MAAM;YACzB,MAAM,KAAK,GAAG,WAAW,CAAC,SAAS;YACnC,MAAM,QAAQ,GAAG,WAAW,CAAC;YAC7B,MAAM,gBAAgB,MAAM,MAAM;YAClC,cAAc,SAAS,GAAG,IAAM,QAAQ,cAAc,MAAM,IAAI,EAAE;YAClE,cAAc,OAAO,GAAG,IAAM,OAAO,cAAc,KAAK;QAC1D;QACA,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;IAC9C;AACF;AAEO,eAAe,eAAe,QAAgB,EAAE,QAAiC;IACtF,MAAM,OAAoB;QACxB,IAAI,OAAO,UAAU;QACrB,UAAU,SAAS,WAAW,GAAG,IAAI;QACrC;IACF;IAEA,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,UAAU,UAAU,IAAI,CAAC,iBAAiB;QAChD,QAAQ,SAAS,GAAG;YAClB,MAAM,KAAK,QAAQ,MAAM;YACzB,MAAM,KAAK,GAAG,WAAW,CAAC,SAAS;YACnC,MAAM,QAAQ,GAAG,WAAW,CAAC;YAC7B,MAAM,aAAa,MAAM,GAAG,CAAC;YAC7B,WAAW,SAAS,GAAG,IAAM,QAAQ;YACrC,WAAW,OAAO,GAAG,IAAM,OAAO,WAAW,KAAK;QACpD;QACA,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;IAC9C;AACF;AAEO,eAAe,kBAAkB,EAAU;IAChD,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,UAAU,UAAU,IAAI,CAAC,iBAAiB;QAChD,QAAQ,SAAS,GAAG;YAClB,MAAM,KAAK,QAAQ,MAAM;YACzB,MAAM,KAAK,GAAG,WAAW,CAAC,SAAS;YACnC,MAAM,QAAQ,GAAG,WAAW,CAAC;YAC7B,MAAM,gBAAgB,MAAM,MAAM,CAAC;YACnC,cAAc,SAAS,GAAG,IAAM;YAChC,cAAc,OAAO,GAAG,IAAM,OAAO,cAAc,KAAK;QAC1D;QACA,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;IAC9C;AACF;AAEO,eAAe,kBAAkB,QAAgB,EAAE,QAAgB;IACxE,IAAI;QACF,MAAM,QAAQ,MAAM;QACpB,MAAM,gBAAgB,SAAS,WAAW;QAC1C,MAAM,cAAc,MAAM,IAAI,CAAC,CAAA,IAAK,cAAc,QAAQ,CAAC,EAAE,QAAQ,KAAK,EAAE,QAAQ,CAAC,QAAQ,CAAC;QAC9F,OAAO,cAAc,YAAY,QAAQ,GAAG;IAC9C,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,SAAS,kBAAkB,KAAoB;IACpD,OAAO,KAAK,SAAS,CAAC;AACxB;AAEO,SAAS,oBAAoB,OAAe;IACjD,OAAO,KAAK,KAAK,CAAC;AACpB"}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/camera-capture.tsx"],"sourcesContent":["'use client'\n\nimport { useRef, useState } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Card } from '@/components/ui/card'\nimport { Camera, Loader2, AlertCircle, Upload } from 'lucide-react'\nimport { saveExpenseToIndexedDB } from '@/lib/db-utils'\nimport { applyReceiptRules } from '@/lib/receipt-rules'\n\ninterface CameraCaptureProps {\n  onExpenseAdded: (expense: any) => void\n  onProcessingComplete?: () => void\n}\n\nexport default function CameraCapture({ onExpenseAdded, onProcessingComplete }: CameraCaptureProps) {\n  const cameraInputRef = useRef<HTMLInputElement>(null)\n  const galleryInputRef = useRef<HTMLInputElement>(null)\n  const [isProcessing, setIsProcessing] = useState(false)\n  const [previewImage, setPreviewImage] = useState<string | null>(null)\n  const [error, setError] = useState<string | null>(null)\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n\n    const maxSize = 10 * 1024 * 1024\n    if (file.size > maxSize) {\n      setError('File too large. Please use an image under 10MB.')\n      return\n    }\n\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      setPreviewImage(e.target?.result as string)\n      setError(null)\n    }\n    reader.onerror = () => setError('Failed to read file.')\n    reader.readAsDataURL(file)\n  }\n\n  const handleProcessReceipt = async () => {\n    if (!previewImage) return\n    setIsProcessing(true)\n    setError(null)\n\n    try {\n      console.log('[v0] Starting receipt processing...')\n      \n      // Extract base64 from data URL\n      const match = previewImage.match(/base64,(.+)$/)\n      const imageBase64 = match ? match[1] : previewImage\n      \n      const response = await fetch('/api/process-receipt', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ imageBase64 })\n      })\n      \n      const result = await response.json()\n      \n      if (!result.ok) {\n        setError(result.error || 'Failed to process receipt')\n        return\n      }\n      \n      console.log('[v0] Receipt processed successfully:', result.data)\n      \n      // Apply receipt rules to override category if rule exists\n      result.data.category = await applyReceiptRules(result.data.merchant, result.data.category)\n      \n      const expense = await saveExpenseToIndexedDB(result.data)\n      onExpenseAdded(expense)\n      setPreviewImage(null)\n      onProcessingComplete?.()\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to process receipt'\n      console.error('[v0] Processing failed:', errorMessage)\n      setError(errorMessage)\n    } finally {\n      setIsProcessing(false)\n    }\n  }\n\n  if (previewImage) {\n    return (\n      <div className=\"space-y-4\">\n        <Card className=\"overflow-hidden\">\n          <img\n            src={previewImage || \"/placeholder.svg\"}\n            alt=\"Receipt\"\n            className=\"w-full h-96 object-cover\"\n          />\n        </Card>\n\n        {error && (\n          <Card className=\"bg-red-50 dark:bg-red-950 border-red-200 p-4 flex gap-3\">\n            <AlertCircle className=\"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5\" />\n            <p className=\"text-sm text-red-900\">{error}</p>\n          </Card>\n        )}\n\n        <div className=\"flex gap-3\">\n          <Button onClick={() => setPreviewImage(null)} variant=\"outline\" className=\"flex-1\">\n            Retake\n          </Button>\n          <Button onClick={handleProcessReceipt} disabled={isProcessing} className=\"flex-1\">\n            {isProcessing && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n            {isProcessing ? 'Processing...' : 'Process'}\n          </Button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <Card className=\"p-8\">\n      <div className=\"flex flex-col items-center justify-center space-y-6\">\n        <div className=\"bg-primary/10 p-4 rounded-full\">\n          <Camera className=\"h-12 w-12 text-primary\" />\n        </div>\n\n        <div className=\"text-center space-y-2\">\n          <h3 className=\"text-lg font-semibold\">Snap Your Receipt</h3>\n          <p className=\"text-sm text-muted-foreground\">\n            Take a photo or upload from your gallery\n          </p>\n        </div>\n\n        <div className=\"w-full space-y-3\">\n          <Button onClick={() => cameraInputRef.current?.click()} className=\"w-full\" size=\"lg\">\n            <Camera className=\"mr-2 h-4 w-4\" />\n            Take Photo with Camera\n          </Button>\n\n          <Button onClick={() => galleryInputRef.current?.click()} variant=\"outline\" className=\"w-full\" size=\"lg\">\n            <Upload className=\"mr-2 h-4 w-4\" />\n            Choose from Gallery\n          </Button>\n        </div>\n\n        {/* Camera input - opens native camera */}\n        <input\n          ref={cameraInputRef}\n          type=\"file\"\n          accept=\"image/*\"\n          capture=\"environment\"\n          onChange={handleFileUpload}\n          className=\"hidden\"\n        />\n\n        {/* Gallery input - opens photo gallery */}\n        <input\n          ref={galleryInputRef}\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={handleFileUpload}\n          className=\"hidden\"\n        />\n      </div>\n\n      {error && (\n        <div className=\"mt-4 p-4 bg-red-50 dark:bg-red-950 border border-red-200 rounded-lg flex gap-3\">\n          <AlertCircle className=\"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5\" />\n          <p className=\"text-sm text-red-900\">{error}</p>\n        </div>\n      )}\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 685, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/lib/export-utils.tsx"],"sourcesContent":["interface Expense {\n  id: string\n  merchant: string\n  amount: number\n  category: string\n  date: string\n}\n\nexport function exportToCSV(expenses: Expense[]): void {\n  const headers = ['Date', 'Merchant', 'Amount', 'Category']\n  const rows = expenses.map(exp => [\n    new Date(exp.date).toLocaleDateString(),\n    exp.merchant,\n    `$${exp.amount.toFixed(2)}`,\n    exp.category\n  ])\n\n  const csv = [\n    headers.join(','),\n    ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\n  ].join('\\n')\n\n  downloadFile(csv, 'expenses.csv', 'text/csv')\n}\n\nexport function exportToPDF(expenses: Expense[]): void {\n  // Simple PDF generation using data URL and print\n  const total = expenses.reduce((sum, exp) => sum + exp.amount, 0)\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>Expense Report</title>\n      <style>\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        h1 { color: #333; }\n        table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n        th { background-color: #f5f5f5; font-weight: bold; }\n        .total { font-weight: bold; font-size: 18px; margin-top: 20px; }\n      </style>\n    </head>\n    <body>\n      <h1>Expense Report</h1>\n      <p>Generated: ${new Date().toLocaleDateString()}</p>\n      <table>\n        <thead>\n          <tr>\n            <th>Date</th>\n            <th>Merchant</th>\n            <th>Amount</th>\n            <th>Category</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${expenses.map(exp => `\n            <tr>\n              <td>${new Date(exp.date).toLocaleDateString()}</td>\n              <td>${exp.merchant}</td>\n              <td>$${exp.amount.toFixed(2)}</td>\n              <td>${exp.category}</td>\n            </tr>\n          `).join('')}\n        </tbody>\n      </table>\n      <div class=\"total\">Total Expenses: $${total.toFixed(2)}</div>\n    </body>\n    </html>\n  `\n\n  const newWindow = window.open()\n  if (newWindow) {\n    newWindow.document.write(html)\n    newWindow.document.close()\n    newWindow.print()\n  }\n}\n\nfunction downloadFile(content: string, filename: string, type: string): void {\n  const blob = new Blob([content], { type })\n  const url = URL.createObjectURL(blob)\n  const link = document.createElement('a')\n  link.href = url\n  link.download = filename\n  document.body.appendChild(link)\n  link.click()\n  document.body.removeChild(link)\n  URL.revokeObjectURL(url)\n}\n"],"names":[],"mappings":";;;;;;AAQO,SAAS,YAAY,QAAmB;IAC7C,MAAM,UAAU;QAAC;QAAQ;QAAY;QAAU;KAAW;IAC1D,MAAM,OAAO,SAAS,GAAG,CAAC,CAAA,MAAO;YAC/B,IAAI,KAAK,IAAI,IAAI,EAAE,kBAAkB;YACrC,IAAI,QAAQ;YACZ,CAAC,CAAC,EAAE,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI;YAC3B,IAAI,QAAQ;SACb;IAED,MAAM,MAAM;QACV,QAAQ,IAAI,CAAC;WACV,KAAK,GAAG,CAAC,CAAA,MAAO,IAAI,GAAG,CAAC,CAAA,OAAQ,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC;KACtD,CAAC,IAAI,CAAC;IAEP,aAAa,KAAK,gBAAgB;AACpC;AAEO,SAAS,YAAY,QAAmB;IAC7C,iDAAiD;IACjD,MAAM,QAAQ,SAAS,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,IAAI,MAAM,EAAE;IAE9D,MAAM,OAAO,CAAC;;;;;;;;;;;;;;;;oBAgBI,EAAE,IAAI,OAAO,kBAAkB,GAAG;;;;;;;;;;;UAW5C,EAAE,SAAS,GAAG,CAAC,CAAA,MAAO,CAAC;;kBAEf,EAAE,IAAI,KAAK,IAAI,IAAI,EAAE,kBAAkB,GAAG;kBAC1C,EAAE,IAAI,QAAQ,CAAC;mBACd,EAAE,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG;kBACzB,EAAE,IAAI,QAAQ,CAAC;;UAEvB,CAAC,EAAE,IAAI,CAAC,IAAI;;;0CAGoB,EAAE,MAAM,OAAO,CAAC,GAAG;;;EAG3D,CAAC;IAED,MAAM,YAAY,OAAO,IAAI;IAC7B,IAAI,WAAW;QACb,UAAU,QAAQ,CAAC,KAAK,CAAC;QACzB,UAAU,QAAQ,CAAC,KAAK;QACxB,UAAU,KAAK;IACjB;AACF;AAEA,SAAS,aAAa,OAAe,EAAE,QAAgB,EAAE,IAAY;IACnE,MAAM,OAAO,IAAI,KAAK;QAAC;KAAQ,EAAE;QAAE;IAAK;IACxC,MAAM,MAAM,IAAI,eAAe,CAAC;IAChC,MAAM,OAAO,SAAS,aAAa,CAAC;IACpC,KAAK,IAAI,GAAG;IACZ,KAAK,QAAQ,GAAG;IAChB,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,KAAK,KAAK;IACV,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,IAAI,eAAe,CAAC;AACtB"}},
    {"offset": {"line": 780, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/expense-list.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { Card } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Trash2, Download } from 'lucide-react'\nimport { deleteExpenseFromIndexedDB } from '@/lib/db-utils'\nimport { exportToCSV, exportToPDF } from '@/lib/export-utils'\n\ninterface Expense {\n  id: string\n  merchant: string\n  amount: number\n  category: string\n  date: string\n  receipt?: string\n}\n\ninterface ExpenseListProps {\n  expenses: Expense[]\n  onExpenseDeleted: (id: string) => void\n}\n\nconst categoryColors: Record<string, string> = {\n  'Food': 'bg-orange-100 text-orange-900 dark:bg-orange-900/30 dark:text-orange-200',\n  'Travel': 'bg-blue-100 text-blue-900 dark:bg-blue-900/30 dark:text-blue-200',\n  'Office': 'bg-purple-100 text-purple-900 dark:bg-purple-900/30 dark:text-purple-200',\n  'Other': 'bg-gray-100 text-gray-900 dark:bg-gray-900/30 dark:text-gray-200',\n}\n\nexport default function ExpenseList({ expenses, onExpenseDeleted }: ExpenseListProps) {\n  const [selectedExpenses, setSelectedExpenses] = useState<string[]>([])\n\n  const handleDelete = async (id: string) => {\n    await deleteExpenseFromIndexedDB(id)\n    onExpenseDeleted(id)\n  }\n\n  // Filter out invalid expenses and ensure amounts are valid\n  const validExpenses = expenses.filter(exp => {\n    const amount = Number(exp.amount)\n    return isFinite(amount) && amount >= 0\n  })\n\n  const totalAmount = validExpenses.reduce((sum, exp) => {\n    const amount = Number(exp.amount)\n    return sum + (isFinite(amount) ? amount : 0)\n  }, 0)\n  \n  const categoryBreakdown = validExpenses.reduce((acc, exp) => {\n    const amount = Number(exp.amount)\n    if (isFinite(amount)) {\n      acc[exp.category] = (acc[exp.category] || 0) + amount\n    }\n    return acc\n  }, {} as Record<string, number>)\n\n  if (expenses.length === 0) {\n    return (\n      <Card className=\"p-8 text-center\">\n        <div className=\"space-y-3\">\n          <div className=\"text-6xl\">ðŸ“‹</div>\n          <h3 className=\"text-lg font-semibold text-foreground\">No expenses yet</h3>\n          <p className=\"text-sm text-muted-foreground\">\n            Start scanning receipts to track your expenses\n          </p>\n        </div>\n      </Card>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n        <Card className=\"p-4 bg-primary/5 border-primary/20\">\n          <p className=\"text-sm text-muted-foreground\">Total Spent</p>\n          <p className=\"text-2xl font-bold text-primary\">${totalAmount.toFixed(2)}</p>\n        </Card>\n        <Card className=\"p-4 bg-accent/5 border-accent/20\">\n          <p className=\"text-sm text-muted-foreground\">Transactions</p>\n          <p className=\"text-2xl font-bold text-accent\">{validExpenses.length}</p>\n        </Card>\n        <Card className=\"p-4 bg-secondary/10 border-secondary/20\">\n          <p className=\"text-sm text-muted-foreground\">Avg. Per Receipt</p>\n          <p className=\"text-2xl font-bold text-foreground\">${validExpenses.length > 0 ? (totalAmount / validExpenses.length).toFixed(2) : '0.00'}</p>\n        </Card>\n      </div>\n\n      {/* Category Breakdown */}\n      {Object.keys(categoryBreakdown).length > 0 && (\n        <Card className=\"p-4\">\n          <h4 className=\"font-semibold text-foreground mb-3\">By Category</h4>\n          <div className=\"space-y-2\">\n            {Object.entries(categoryBreakdown).map(([category, amount]) => (\n              <div key={category} className=\"flex items-center justify-between text-sm\">\n                <span className=\"text-muted-foreground\">{category}</span>\n                <span className=\"font-medium text-foreground\">${amount.toFixed(2)}</span>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {/* Export Options */}\n      <div className=\"flex gap-2\">\n        <Button\n          onClick={() => exportToCSV(expenses)}\n          variant=\"outline\"\n          className=\"flex-1\"\n        >\n          <Download className=\"mr-2 h-4 w-4\" />\n          Export CSV\n        </Button>\n        <Button\n          onClick={() => exportToPDF(expenses)}\n          variant=\"outline\"\n          className=\"flex-1\"\n        >\n          <Download className=\"mr-2 h-4 w-4\" />\n          Export PDF\n        </Button>\n      </div>\n\n      {/* Expense List */}\n      <div className=\"space-y-3\">\n        <h3 className=\"font-semibold text-foreground\">Recent Expenses</h3>\n        {validExpenses.map((expense) => {\n          const amount = Number(expense.amount)\n          return (\n            <Card key={expense.id} className=\"p-4 hover:bg-secondary/50 transition-colors\">\n              <div className=\"flex items-start justify-between gap-4\">\n                <div className=\"flex-1 space-y-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <h4 className=\"font-medium text-foreground\">{expense.merchant}</h4>\n                    <span className={`text-xs px-2 py-1 rounded-full ${categoryColors[expense.category] || categoryColors['Other']}`}>\n                      {expense.category}\n                    </span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {new Date(expense.date).toLocaleDateString()} at {new Date(expense.date).toLocaleTimeString()}\n                  </p>\n                </div>\n                <div className=\"text-right space-y-2\">\n                  <p className=\"text-lg font-bold text-primary\">${isFinite(amount) ? amount.toFixed(2) : '0.00'}</p>\n                  <Button\n                    onClick={() => handleDelete(expense.id)}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"text-destructive hover:bg-destructive/10\"\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AAPA;;;;;;;;AAuBA,MAAM,iBAAyC;IAC7C,QAAQ;IACR,UAAU;IACV,UAAU;IACV,SAAS;AACX;AAEe,SAAS,YAAY,EAAE,QAAQ,EAAE,gBAAgB,EAAoB;IAClF,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,gVAAQ,EAAW,EAAE;IAErE,MAAM,eAAe,OAAO;QAC1B,MAAM,IAAA,gJAA0B,EAAC;QACjC,iBAAiB;IACnB;IAEA,2DAA2D;IAC3D,MAAM,gBAAgB,SAAS,MAAM,CAAC,CAAA;QACpC,MAAM,SAAS,OAAO,IAAI,MAAM;QAChC,OAAO,SAAS,WAAW,UAAU;IACvC;IAEA,MAAM,cAAc,cAAc,MAAM,CAAC,CAAC,KAAK;QAC7C,MAAM,SAAS,OAAO,IAAI,MAAM;QAChC,OAAO,MAAM,CAAC,SAAS,UAAU,SAAS,CAAC;IAC7C,GAAG;IAEH,MAAM,oBAAoB,cAAc,MAAM,CAAC,CAAC,KAAK;QACnD,MAAM,SAAS,OAAO,IAAI,MAAM;QAChC,IAAI,SAAS,SAAS;YACpB,GAAG,CAAC,IAAI,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI;QACjD;QACA,OAAO;IACT,GAAG,CAAC;IAEJ,IAAI,SAAS,MAAM,KAAK,GAAG;QACzB,qBACE,6WAAC,iIAAI;YAAC,WAAU;sBACd,cAAA,6WAAC;gBAAI,WAAU;;kCACb,6WAAC;wBAAI,WAAU;kCAAW;;;;;;kCAC1B,6WAAC;wBAAG,WAAU;kCAAwC;;;;;;kCACtD,6WAAC;wBAAE,WAAU;kCAAgC;;;;;;;;;;;;;;;;;IAMrD;IAEA,qBACE,6WAAC;QAAI,WAAU;;0BAEb,6WAAC;gBAAI,WAAU;;kCACb,6WAAC,iIAAI;wBAAC,WAAU;;0CACd,6WAAC;gCAAE,WAAU;0CAAgC;;;;;;0CAC7C,6WAAC;gCAAE,WAAU;;oCAAkC;oCAAE,YAAY,OAAO,CAAC;;;;;;;;;;;;;kCAEvE,6WAAC,iIAAI;wBAAC,WAAU;;0CACd,6WAAC;gCAAE,WAAU;0CAAgC;;;;;;0CAC7C,6WAAC;gCAAE,WAAU;0CAAkC,cAAc,MAAM;;;;;;;;;;;;kCAErE,6WAAC,iIAAI;wBAAC,WAAU;;0CACd,6WAAC;gCAAE,WAAU;0CAAgC;;;;;;0CAC7C,6WAAC;gCAAE,WAAU;;oCAAqC;oCAAE,cAAc,MAAM,GAAG,IAAI,CAAC,cAAc,cAAc,MAAM,EAAE,OAAO,CAAC,KAAK;;;;;;;;;;;;;;;;;;;YAKpI,OAAO,IAAI,CAAC,mBAAmB,MAAM,GAAG,mBACvC,6WAAC,iIAAI;gBAAC,WAAU;;kCACd,6WAAC;wBAAG,WAAU;kCAAqC;;;;;;kCACnD,6WAAC;wBAAI,WAAU;kCACZ,OAAO,OAAO,CAAC,mBAAmB,GAAG,CAAC,CAAC,CAAC,UAAU,OAAO,iBACxD,6WAAC;gCAAmB,WAAU;;kDAC5B,6WAAC;wCAAK,WAAU;kDAAyB;;;;;;kDACzC,6WAAC;wCAAK,WAAU;;4CAA8B;4CAAE,OAAO,OAAO,CAAC;;;;;;;;+BAFvD;;;;;;;;;;;;;;;;0BAUlB,6WAAC;gBAAI,WAAU;;kCACb,6WAAC,qIAAM;wBACL,SAAS,IAAM,IAAA,sIAAW,EAAC;wBAC3B,SAAQ;wBACR,WAAU;;0CAEV,6WAAC,0SAAQ;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;kCAGvC,6WAAC,qIAAM;wBACL,SAAS,IAAM,IAAA,sIAAW,EAAC;wBAC3B,SAAQ;wBACR,WAAU;;0CAEV,6WAAC,0SAAQ;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;;;;;;;0BAMzC,6WAAC;gBAAI,WAAU;;kCACb,6WAAC;wBAAG,WAAU;kCAAgC;;;;;;oBAC7C,cAAc,GAAG,CAAC,CAAC;wBAClB,MAAM,SAAS,OAAO,QAAQ,MAAM;wBACpC,qBACE,6WAAC,iIAAI;4BAAkB,WAAU;sCAC/B,cAAA,6WAAC;gCAAI,WAAU;;kDACb,6WAAC;wCAAI,WAAU;;0DACb,6WAAC;gDAAI,WAAU;;kEACb,6WAAC;wDAAG,WAAU;kEAA+B,QAAQ,QAAQ;;;;;;kEAC7D,6WAAC;wDAAK,WAAW,CAAC,+BAA+B,EAAE,cAAc,CAAC,QAAQ,QAAQ,CAAC,IAAI,cAAc,CAAC,QAAQ,EAAE;kEAC7G,QAAQ,QAAQ;;;;;;;;;;;;0DAGrB,6WAAC;gDAAE,WAAU;;oDACV,IAAI,KAAK,QAAQ,IAAI,EAAE,kBAAkB;oDAAG;oDAAK,IAAI,KAAK,QAAQ,IAAI,EAAE,kBAAkB;;;;;;;;;;;;;kDAG/F,6WAAC;wCAAI,WAAU;;0DACb,6WAAC;gDAAE,WAAU;;oDAAiC;oDAAE,SAAS,UAAU,OAAO,OAAO,CAAC,KAAK;;;;;;;0DACvF,6WAAC,qIAAM;gDACL,SAAS,IAAM,aAAa,QAAQ,EAAE;gDACtC,SAAQ;gDACR,MAAK;gDACL,WAAU;0DAEV,cAAA,6WAAC,wSAAM;oDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;2BArBf,QAAQ,EAAE;;;;;oBA2BzB;;;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 1192, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/lib/use-theme.ts"],"sourcesContent":["import { useState, useEffect } from 'react'\n\ntype Theme = 'light' | 'dark'\n\nexport function useTheme() {\n  const [theme, setTheme] = useState<Theme>('light')\n  const [mounted, setMounted] = useState(false)\n\n  // Initialize theme from localStorage or system preference\n  useEffect(() => {\n    const stored = localStorage.getItem('theme') as Theme | null\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches\n    \n    const initialTheme: Theme = stored || (prefersDark ? 'dark' : 'light')\n    setTheme(initialTheme)\n    applyTheme(initialTheme)\n    setMounted(true)\n  }, [])\n\n  const applyTheme = (newTheme: Theme) => {\n    const html = document.documentElement\n    if (newTheme === 'dark') {\n      html.classList.add('dark')\n    } else {\n      html.classList.remove('dark')\n    }\n    localStorage.setItem('theme', newTheme)\n  }\n\n  const toggleTheme = () => {\n    const newTheme: Theme = theme === 'light' ? 'dark' : 'light'\n    setTheme(newTheme)\n    applyTheme(newTheme)\n  }\n\n  return { theme, toggleTheme, mounted }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAIO,SAAS;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gVAAQ,EAAQ;IAC1C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAC;IAEvC,0DAA0D;IAC1D,IAAA,iVAAS,EAAC;QACR,MAAM,SAAS,aAAa,OAAO,CAAC;QACpC,MAAM,cAAc,OAAO,UAAU,CAAC,gCAAgC,OAAO;QAE7E,MAAM,eAAsB,UAAU,CAAC,cAAc,SAAS,OAAO;QACrE,SAAS;QACT,WAAW;QACX,WAAW;IACb,GAAG,EAAE;IAEL,MAAM,aAAa,CAAC;QAClB,MAAM,OAAO,SAAS,eAAe;QACrC,IAAI,aAAa,QAAQ;YACvB,KAAK,SAAS,CAAC,GAAG,CAAC;QACrB,OAAO;YACL,KAAK,SAAS,CAAC,MAAM,CAAC;QACxB;QACA,aAAa,OAAO,CAAC,SAAS;IAChC;IAEA,MAAM,cAAc;QAClB,MAAM,WAAkB,UAAU,UAAU,SAAS;QACrD,SAAS;QACT,WAAW;IACb;IAEA,OAAO;QAAE;QAAO;QAAa;IAAQ;AACvC"}},
    {"offset": {"line": 1234, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/theme-toggle.tsx"],"sourcesContent":["'use client'\n\nimport { Moon, Sun } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { useTheme } from '@/lib/use-theme'\n\nexport function ThemeToggle() {\n  const { theme, toggleTheme, mounted } = useTheme()\n\n  if (!mounted) return null\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      className=\"rounded-full\"\n      title={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}\n    >\n      {theme === 'light' ? (\n        <Moon className=\"h-5 w-5\" />\n      ) : (\n        <Sun className=\"h-5 w-5\" />\n      )}\n    </Button>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AAJA;;;;;AAMO,SAAS;IACd,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,OAAO,EAAE,GAAG,IAAA,+HAAQ;IAEhD,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE,6WAAC,qIAAM;QACL,SAAQ;QACR,MAAK;QACL,SAAS;QACT,WAAU;QACV,OAAO,CAAC,UAAU,EAAE,UAAU,UAAU,SAAS,QAAQ,KAAK,CAAC;kBAE9D,UAAU,wBACT,6WAAC,8RAAI;YAAC,WAAU;;;;;iCAEhB,6WAAC,2RAAG;YAAC,WAAU;;;;;;;;;;;AAIvB"}},
    {"offset": {"line": 1280, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/settings.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Card } from '@/components/ui/card'\nimport { Mail } from 'lucide-react'\n\ninterface SettingsProps {\n  expenses: any[]\n  onClose: () => void\n}\n\nexport function Settings({ expenses, onClose }: SettingsProps) {\n  const [emailDigestEnabled, setEmailDigestEnabled] = useState(false)\n\n  // Load setting from localStorage\n  useEffect(() => {\n    const stored = localStorage.getItem('emailDigestEnabled')\n    setEmailDigestEnabled(stored === 'true')\n  }, [])\n\n  const handleEmailDigestToggle = () => {\n    const newValue = !emailDigestEnabled\n    setEmailDigestEnabled(newValue)\n    localStorage.setItem('emailDigestEnabled', String(newValue))\n  }\n\n  const handleShareDigest = async () => {\n    try {\n      const thisWeek = expenses.filter(exp => {\n        const expDate = new Date(exp.date)\n        const weekAgo = new Date()\n        weekAgo.setDate(weekAgo.getDate() - 7)\n        return expDate > weekAgo\n      })\n\n      const totalThisWeek = thisWeek.reduce((sum, exp) => sum + (exp.amount || 0), 0)\n      const subject = `ReceiptSnap Weekly Summary - $${totalThisWeek.toFixed(2)}`\n      const body = `\nWeekly Expense Summary from ReceiptSnap\n\nTotal This Week: $${totalThisWeek.toFixed(2)}\nTransactions: ${thisWeek.length}\n\nExpenses:\n${thisWeek.map(e => `- ${e.merchant} (${e.category}): $${e.amount.toFixed(2)}`).join('\\n')}\n\nExport your full data at: ${typeof window !== 'undefined' ? window.location.origin : 'https://receiptsnap.app'}\n      `.trim()\n\n      // Use native share API\n      if (navigator.share) {\n        await navigator.share({\n          title: 'ReceiptSnap Weekly Summary',\n          text: body,\n        })\n      } else if (navigator.canShare && navigator.canShare({ url: '', title: '' })) {\n        // Fallback: open mail client\n        const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`\n        window.location.href = mailtoLink\n      }\n    } catch (error) {\n      console.error('Share failed:', error)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"w-full max-w-md p-6 space-y-6\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Settings</h2>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n            <label className=\"text-sm font-medium cursor-pointer flex items-center gap-2\">\n              <Mail className=\"h-4 w-4\" />\n              Weekly Email Digest\n            </label>\n            <input\n              type=\"checkbox\"\n              checked={emailDigestEnabled}\n              onChange={handleEmailDigestToggle}\n              className=\"h-4 w-4 cursor-pointer\"\n            />\n          </div>\n\n          {emailDigestEnabled && (\n            <div className=\"p-3 bg-primary/10 rounded-lg space-y-2\">\n              <p className=\"text-xs text-muted-foreground\">\n                Every Sunday at 19:00, you can share your weekly summary via email.\n              </p>\n              <Button\n                onClick={handleShareDigest}\n                size=\"sm\"\n                className=\"w-full\"\n              >\n                Share This Week's Summary\n              </Button>\n            </div>\n          )}\n        </div>\n\n        <Button onClick={onClose} variant=\"outline\" className=\"w-full\">\n          Close\n        </Button>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAYO,SAAS,SAAS,EAAE,QAAQ,EAAE,OAAO,EAAiB;IAC3D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,gVAAQ,EAAC;IAE7D,iCAAiC;IACjC,IAAA,iVAAS,EAAC;QACR,MAAM,SAAS,aAAa,OAAO,CAAC;QACpC,sBAAsB,WAAW;IACnC,GAAG,EAAE;IAEL,MAAM,0BAA0B;QAC9B,MAAM,WAAW,CAAC;QAClB,sBAAsB;QACtB,aAAa,OAAO,CAAC,sBAAsB,OAAO;IACpD;IAEA,MAAM,oBAAoB;QACxB,IAAI;YACF,MAAM,WAAW,SAAS,MAAM,CAAC,CAAA;gBAC/B,MAAM,UAAU,IAAI,KAAK,IAAI,IAAI;gBACjC,MAAM,UAAU,IAAI;gBACpB,QAAQ,OAAO,CAAC,QAAQ,OAAO,KAAK;gBACpC,OAAO,UAAU;YACnB;YAEA,MAAM,gBAAgB,SAAS,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,CAAC,IAAI,MAAM,IAAI,CAAC,GAAG;YAC7E,MAAM,UAAU,CAAC,8BAA8B,EAAE,cAAc,OAAO,CAAC,IAAI;YAC3E,MAAM,OAAO,CAAC;;;kBAGF,EAAE,cAAc,OAAO,CAAC,GAAG;cAC/B,EAAE,SAAS,MAAM,CAAC;;;AAGhC,EAAE,SAAS,GAAG,CAAC,CAAA,IAAK,CAAC,EAAE,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE,EAAE,QAAQ,CAAC,IAAI,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM;;0BAEjE,EAAE,sCAAgC,0BAAyB,0BAA0B;MACzG,CAAC,CAAC,IAAI;YAEN,uBAAuB;YACvB,IAAI,UAAU,KAAK,EAAE;gBACnB,MAAM,UAAU,KAAK,CAAC;oBACpB,OAAO;oBACP,MAAM;gBACR;YACF,OAAO,IAAI,UAAU,QAAQ,IAAI,UAAU,QAAQ,CAAC;gBAAE,KAAK;gBAAI,OAAO;YAAG,IAAI;gBAC3E,6BAA6B;gBAC7B,MAAM,aAAa,CAAC,gBAAgB,EAAE,mBAAmB,SAAS,MAAM,EAAE,mBAAmB,OAAO;gBACpG,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iBAAiB;QACjC;IACF;IAEA,qBACE,6WAAC;QAAI,WAAU;kBACb,cAAA,6WAAC,iIAAI;YAAC,WAAU;;8BACd,6WAAC;8BACC,cAAA,6WAAC;wBAAG,WAAU;kCAAqB;;;;;;;;;;;8BAGrC,6WAAC;oBAAI,WAAU;;sCACb,6WAAC;4BAAI,WAAU;;8CACb,6WAAC;oCAAM,WAAU;;sDACf,6WAAC,8RAAI;4CAAC,WAAU;;;;;;wCAAY;;;;;;;8CAG9B,6WAAC;oCACC,MAAK;oCACL,SAAS;oCACT,UAAU;oCACV,WAAU;;;;;;;;;;;;wBAIb,oCACC,6WAAC;4BAAI,WAAU;;8CACb,6WAAC;oCAAE,WAAU;8CAAgC;;;;;;8CAG7C,6WAAC,qIAAM;oCACL,SAAS;oCACT,MAAK;oCACL,WAAU;8CACX;;;;;;;;;;;;;;;;;;8BAOP,6WAAC,qIAAM;oBAAC,SAAS;oBAAS,SAAQ;oBAAU,WAAU;8BAAS;;;;;;;;;;;;;;;;;AAMvE"}},
    {"offset": {"line": 1463, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/components/ui/tabs.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as TabsPrimitive from '@radix-ui/react-tabs'\n\nimport { cn } from '@/lib/utils'\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn('flex flex-col gap-2', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        'bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn('flex-1 outline-none', className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6WAAC,8YAAkB;QACjB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6WAAC,8YAAkB;QACjB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6WAAC,iZAAqB;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6WAAC,iZAAqB;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1529, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-receipt-scanner-app/app/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport CameraCapture from '@/components/camera-capture'\nimport ExpenseList from '@/components/expense-list'\nimport { ThemeToggle } from '@/components/theme-toggle'\nimport { Settings } from '@/components/settings'\nimport { TaxPacketModal } from '@/components/tax-packet-modal'\nimport { Card } from '@/components/ui/card'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Settings as SettingsIcon } from 'lucide-react'\n\nexport default function Home() {\n  const [expenses, setExpenses] = useState<any[]>([])\n  const [scanCount, setScanCount] = useState(0)\n  const [isLoading, setIsLoading] = useState(true)\n  const [activeTab, setActiveTab] = useState('scan')\n  const [showSettings, setShowSettings] = useState(false)\n  const [showTaxPacket, setShowTaxPacket] = useState(false)\n\n  // Load data from IndexedDB on mount\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        const db = await openIndexedDB()\n        const tx = db.transaction('expenses', 'readonly')\n        const store = tx.objectStore('expenses')\n        const allExpenses = await new Promise((resolve, reject) => {\n          const request = store.getAll()\n          request.onsuccess = () => resolve(request.result)\n          request.onerror = () => reject(request.error)\n        })\n        setExpenses(allExpenses)\n\n        // Load scan count\n        const countTx = db.transaction('metadata', 'readonly')\n        const countStore = countTx.objectStore('metadata')\n        const scanData = await new Promise<any>((resolve) => {\n          const request = countStore.get('scanCount')\n          request.onsuccess = () => resolve(request.result)\n        })\n        if (scanData) {\n          setScanCount(scanData.value)\n        }\n      } catch (error) {\n        console.error('Failed to load data:', error)\n      } finally {\n        setIsLoading(false)\n      }\n    }\n    loadData()\n\n    // Check if today is Jan 1st and user hasn't seen tax packet offer\n    const today = new Date()\n    if (today.getMonth() === 0 && today.getDate() === 1) {\n      const lastTaxOfferDate = localStorage.getItem('lastTaxOfferDate')\n      if (lastTaxOfferDate !== today.toISOString().split('T')[0]) {\n        setShowTaxPacket(true)\n        localStorage.setItem('lastTaxOfferDate', today.toISOString().split('T')[0])\n      }\n    }\n  }, [])\n\n  const handleExpenseAdded = async (newExpense: any) => {\n    try {\n      const db = await openIndexedDB()\n      \n      // Reload expenses\n      const tx = db.transaction('expenses', 'readonly')\n      const store = tx.objectStore('expenses')\n      const allExpenses = await new Promise<any[]>((resolve, reject) => {\n        const request = store.getAll()\n        request.onsuccess = () => resolve(request.result)\n        request.onerror = () => reject(request.error)\n      })\n      setExpenses(allExpenses)\n\n      // Reload scan count\n      const countTx = db.transaction('metadata', 'readonly')\n      const countStore = countTx.objectStore('metadata')\n      const scanData = await new Promise<any>((resolve) => {\n        const request = countStore.get('scanCount')\n        request.onsuccess = () => resolve(request.result)\n      })\n      setScanCount(scanData?.value || 0)\n    } catch (error) {\n      console.error('Failed to reload data:', error)\n    }\n  }\n\n  const handleExpenseDeleted = (id: string) => {\n    setExpenses(expenses.filter(e => e.id !== id))\n  }\n\n  const handleResetScans = async () => {\n    const db = await openIndexedDB()\n    const tx = db.transaction('metadata', 'readwrite')\n    const store = tx.objectStore('metadata')\n    await new Promise<void>((resolve) => {\n      const request = store.put({ key: 'scanCount', value: 0 })\n      request.onsuccess = () => resolve()\n    })\n    setScanCount(0)\n  }\n\n  const handleProcessingComplete = () => {\n    setActiveTab('expenses')\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading your expenses...</p>\n        </div>\n      </div>\n    )\n  }\n\n  const isFreemiumLimited = scanCount >= 10\n  const scansRemaining = Math.max(0, 10 - scanCount)\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-background to-secondary/10 p-4 sm:p-6\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl sm:text-4xl font-bold text-foreground\">ReceiptSnap</h1>\n              <p className=\"text-muted-foreground mt-1\">AI-powered expense tracking</p>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <div className=\"bg-primary/10 border border-primary/20 rounded-lg p-3 text-right\">\n                <p className=\"text-xs text-muted-foreground\">Free scans remaining</p>\n                <p className=\"text-2xl font-bold text-primary\">{scansRemaining}</p>\n                {scanCount > 0 && (\n                  <button \n                    onClick={handleResetScans}\n                    className=\"text-xs text-primary hover:underline mt-2\"\n                  >\n                    Reset (test)\n                  </button>\n                )}\n              </div>\n              <button\n                onClick={() => setShowSettings(true)}\n                className=\"p-2 hover:bg-secondary rounded-lg transition-colors\"\n                title=\"Settings\"\n              >\n                <SettingsIcon className=\"h-5 w-5\" />\n              </button>\n              <ThemeToggle />\n            </div>\n          </div>\n        </div>\n\n        {/* Freemium Notice */}\n        {isFreemiumLimited && (\n          <Card className=\"bg-amber-50 dark:bg-amber-950 border-amber-200 dark:border-amber-800 p-4\">\n            <p className=\"text-sm text-amber-900 dark:text-amber-100\">\n              You've reached your monthly free limit. Upgrade to unlimited scanning for $4.99/month.\n            </p>\n          </Card>\n        )}\n\n        {/* Main Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-6\">\n            <TabsTrigger value=\"scan\">Scan Receipt</TabsTrigger>\n            <TabsTrigger value=\"expenses\">Expenses ({expenses.length})</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"scan\" className=\"space-y-4\">\n            {isFreemiumLimited ? (\n              <Card className=\"p-8 text-center\">\n                <p className=\"text-lg font-semibold text-foreground mb-4\">\n                  Monthly limit reached\n                </p>\n                <p className=\"text-muted-foreground mb-6\">\n                  You have 10 free scans per month. Upgrade to continue scanning.\n                </p>\n                <button className=\"bg-primary text-primary-foreground px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors\">\n                  Upgrade to Pro ($4.99/month)\n                </button>\n              </Card>\n            ) : (\n              <CameraCapture \n                onExpenseAdded={handleExpenseAdded}\n                onProcessingComplete={handleProcessingComplete}\n              />\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"expenses\" className=\"space-y-4\">\n            <ExpenseList\n              expenses={expenses}\n              onExpenseDeleted={handleExpenseDeleted}\n            />\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {showSettings && (\n        <Settings\n          expenses={expenses}\n          onClose={() => setShowSettings(false)}\n        />\n      )}\n    </div>\n  )\n}\n\n// IndexedDB initialization\nfunction openIndexedDB(): Promise<IDBDatabase> {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('ReceiptSnapDB', 1)\n    request.onerror = () => reject(request.error)\n    request.onsuccess = () => resolve(request.result)\n    request.onupgradeneeded = (event) => {\n      const db = (event.target as IDBOpenDBRequest).result\n      if (!db.objectStoreNames.contains('expenses')) {\n        db.createObjectStore('expenses', { keyPath: 'id' })\n      }\n      if (!db.objectStoreNames.contains('metadata')) {\n        db.createObjectStore('metadata', { keyPath: 'key' })\n      }\n    }\n  })\n}\n"],"names":[],"mappings":"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"}}]
}